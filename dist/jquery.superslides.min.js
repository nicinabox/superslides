/*! Superslides - v0.5.4-wip - 2013-05-07
* https://github.com/nicinabox/superslides
* Copyright (c) 2013 Nic Aitch; Licensed MIT */
(function(){var e,t,n;n="superslides",e=jQuery,t=function(t,n){var r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B=this;return n==null&&(n={}),this.options=e.extend({play:!1,slide_speed:"normal",slide_easing:"linear",pagination:!0,hashchange:!1,texthash:!1,scrollable:!0,classes:{preserve:"preserve",nav:"slides-navigation",container:"slides-container",pagination:"slides-pagination"}},n),_=this,u=e(window),this.el=e(t),i=e("."+this.options.classes.container,t),r=i.children(),o=e("<nav>",{"class":this.options.classes.pagination}),s=e("<div>",{"class":"slides-control"}),w=1,g=!1,H=u.width(),m=u.height(),y=function(){if(g)return;return w=p(),x(),B.mobile=/mobile/i.test(navigator.userAgent),s=i.wrap(s).parent(".slides-control"),A(),L(),D(),a(),B.start(),B},A=function(){return e("body").css({margin:0}),B.el.css({position:"relative",overflowX:"hidden",width:"100%"}),s.css({position:"relative",transform:"translate3d(0)"}),i.css({display:"none",margin:"0",padding:"0",listStyle:"none",position:"relative"}),O()},O=function(){return i.find("img").not("."+B.options.classes.preserve).css({"-webkit-backface-visibility":"hidden","-ms-interpolation-mode":"bicubic",position:"absolute",left:"0",top:"0","z-index":"-1"})},L=function(){e("body").css({margin:0,overflow:"hidden"}),B.el.css({height:m}),s.css({width:H*w,left:-H});if(B.options.scrollable)return r.each(function(){if(e(".scrollable",this).length)return;return e(this).wrapInner('<div class="scrollable" />'),e(this).find("img").not("."+B.options.classes.preserve).insertBefore(e(".scrollable",this))})},k=function(){return r.is("img")&&(r.wrap("<div>"),r=i.children()),i.children().css({display:"none",position:"absolute",overflow:"hidden",top:0,left:H,zIndex:0}),c(r)},D=function(){return B.size()>1?e("."+B.options.classes.nav).show():e("."+B.options.classes.nav).hide()},v=function(e){return r.eq(e).data("href")},M=function(){return e("."+B.options.classes.nav+" a").each(function(){return e(this).hasClass("next")?this.hash=_.options.texthash?v(_.next):_.next:this.hash=_.options.texthash?v(_.prev):_.prev})},f=function(t){return t>=0||(t=B.size()-1),B.options.texthash&&(t=v(t)),o.append(e("<a>",{href:"#"+t,"class":B.current===o.children().length?"current":void 0}))},a=function(){var n,r;if(!B.options.pagination||B.size()===1)return;return e(t).find("."+B.options.classes.pagination).length?(r=o.children().last().index()+1,n=i.children(),n=n.slice(r)):(r=0,n=new Array(B.size()-r),o=o.appendTo(B.el)),e.each(n,function(e){return f(e+r)})},b=function(t,n){return e("<img>",{src:""+t.attr("src")+"?"+(new Date).getTime()}).load(function(){if(typeof n=="function")return n(this)})},C=function(e){var t;return t=H/e.data("aspect-ratio"),t>=m?e.css({top:-(t-m)/2}):e.css({top:0})},N=function(e){var t;return t=m*e.data("aspect-ratio"),t>=H?e.css({left:-(t-H)/2}):e.css({left:0})},l=function(e){if(!e.data("aspect-ratio")){b(e,function(t){return e.removeAttr("width").removeAttr("height"),e.data("aspect-ratio",t.width/t.height),l(e)});return}return H/m>=e.data("aspect-ratio")?e.css({height:"auto",width:"100%"}):e.css({height:"100%",width:"auto"}),N(e),C(e)},c=function(t){return t.each(function(t){return e(this).width(H).height(m),e(this).css({left:H}),l(e("img",this).not("."+_.options.classes.preserve))})},p=function(){return B.size()===1?1:3},E=function(){var e;return e=B.current+1,e===B.size()&&(e=0),e},T=function(){var e;return e=B.current-1,e<0&&(e=B.size()-1),e},P=function(e){switch(!0){case/next/.test(e):return E();case/prev/.test(e):return T();case/\d/.test(e):return e;default:return!1}},d=function(t){var n;return n=null,r.each(function(r){e(this).data("href")===t&&(n=r)}),n},S=function(e){e==null&&(e=window.location.hash),e=e.replace(/^#/,"");if(e)return _.options.texthash?+d(e):+e},x=function(e){return e==null&&(e=-1),g&&B.current>=0&&e<0&&(e=B.current),B.current=e,B.next=E(),B.prev=T(),!1},h=function(t,n){var u,a,f,l,c;c=P(t);if(c>B.size()-1)return;f=H*2,u=-f,a=B.current;if(t==="prev"||t<a)f=0,u=0;return l=f,r.removeClass("current").eq(c).addClass("current").css({left:l,display:"block"}),o.children().removeClass("current").eq(c).addClass("current"),s.animate({useTranslate3d:B.mobile,left:u},B.options.slide_speed,B.options.slide_easing,function(){return x(c),B.size()>1&&(s.css({left:-H}),r.eq(c).css({left:H,zIndex:2}),a>=0&&r.eq(a).css({left:H,display:"none",zIndex:0})),B.options.hashchange&&(window.location.hash=B.options.texthash?v(B.current):B.current),typeof n=="function"&&n(),M(),B.animating=!1,g?i.trigger("animated.slides"):(g=!0,e("body").css("overflow","visible"),i.fadeIn("fast"),i.trigger("init.slides"))})},this.$el=e(t),this.animate=function(e,t){e==null&&(e="next");if(B.animating)return;return B.animating=!0,h(e,t)},this.update=function(){return r=i.children(),c(r),k(),O(),r.eq(B.current).css({display:"block"}),x(B.current),a(),D(),i.trigger("updated.slides")},this.destroy=function(){return e(t).removeData()},this.size=function(){return i.children().length},this.stop=function(){return clearInterval(B.play_id),delete B.play_id,i.trigger("stopped.slides")},this.start=function(){return k(),B.options.hashchange&&u.trigger("hashchange"),B.animate("next"),B.options.play&&(B.play_id&&B.stop(),B.play_id=setInterval(function(){return B.animate("next")},B.options.play)),i.trigger("started.slides")},u.on("hashchange",function(e){var t;t=S();if(t>=0&&t!==B.current)return B.animate(t)}).on("resize",function(t){return H=u.width(),m=u.height(),L(),c(r),e("body").css({overflow:"visible"})}),e(document).on("click","."+this.options.classes.nav+" a",function(t){return _.options.hashchange||t.preventDefault(),_.stop(),e(this).hasClass("next")?_.animate("next"):_.animate("prev")}).on("click","."+this.options.classes.pagination+" a",function(e){var t;if(!_.options.hashchange)return e.preventDefault(),t=S(this.hash),_.animate(t)}),y()},e.fn[n]=function(r,i){var s;return s=[],this.each(function(){var o,u,a;o=e(this),u=o.data(n),a=typeof r=="object"&&r,u||(s=o.data(n,u=new t(this,a)));if(typeof r=="string"){s=u[r];if(typeof s=="function")return s=s.call(this,i)}}),s}}).call(this);